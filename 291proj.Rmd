---
title: "proj"
author: "Lauren Meyer"
date: "3/21/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
library(readr)
library(tidyverse)
library(ipumsr)
ipumsdata <- read_csv("usa_00004.csv", locale = locale(encoding = "latin1"))
ddi <- read_ipums_ddi("usa_00004.xml")
ipumsdata <- read_ipums_micro(ddi)
head(ipumsdata)
#save(ipumsdata, file = "ipumsdata.rda")
ipumsdata <- read_csv("usa_00004.csv")
small_data <- ipumsdata %>%
  select(YEAR,SERIAL,STATEFIP,METRO,OWNERSHP,HHINCOME,PHONE,CINETHH,SEX,AGE,RACE,EDUC,EMPSTAT,OCC,INCTOT,FTOTINC,DIFFEYE,TRANTIME)
newdata<-small_data %>%
mutate(internet=if_else(CINETHH==3,0,
                if_else(CINETHH %in% 1:2,1,NA_real_)))
samp<-sample_n(newdata,100000)
```

```{r}
m<-glm(internet~as.factor(RACE)+AGE, data=samp, family=binomial)
summary(m)
```
RACE and AGE are significant.
RACE:
1-white
2-black
3-American Indian/Alaskan Native
4-chinese
5-japanese
6-Asian/pacific islander
7-other race
8-2 major races
9-3 or more major races (insignificant)

```{r}

#Adding indicators for just 1,2,3, and 7, the significant interactions
samp <- samp %>%
  mutate(race_int = ifelse(RACE == 1,1, 
                           ifelse(RACE == 2,2,
                                  ifelse(RACE == 3,3,
                                         ifelse(RACE == 7,4,0)))))
m1<-glm(internet~AGE*as.factor(race_int), data=samp, family=binomial)
summary(m1)

anova(m,m1,test="Chisq")
```

```{r}
m2<-glm(internet~as.factor(STATEFIP)+AGE, data=samp, family=binomial)
summary(m2)
```
```{r}
m3<-glm(internet~as.factor(PHONE)+AGE, data=samp, family=binomial)
summary(m3)
m4<-glm(internet~as.factor(PHONE)*AGE, data=samp, family=binomial)
summary(m4)
```

```{r}
m5<-glm(internet~TRANTIME, data=samp, family=binomial)
summary(m5)
m6<-glm(internet~TRANTIME+AGE, data=samp, family=binomial)
summary(m6)
m7<-glm(internet~TRANTIME*AGE, data=samp, family=binomial)
summary(m7)
```

```{r}
m8<-glm(internet~TRANTIME + as.factor(PHONE)+AGE, data=samp, family=binomial)
summary(m8)
m9<-glm(internet~TRANTIME + as.factor(PHONE)+AGE+as.factor(race_int), data=samp, family=binomial)
summary(m9)
m10<-glm(internet~TRANTIME+INCTOT*AGE + as.factor(PHONE)+as.factor(race_int), data=samp, family=binomial)
summary(m10)
```
Note: It seems as though when you try to combine AGE with other variables (by *), AGE becomes less significant.

```{r}
m10<-glm(internet~INCTOT*AGE, data=samp, family=binomial)
summary(m10)
m11<-glm(internet~INCTOT, data=samp, family=binomial)
summary(m11)
```
INCTOT*AGE makes INCTOT's coefficient negative, which doesn't really make sense.

```{r}
m12<-glm(internet~as.factor(DIFFEYE), data=samp, family=binomial)
summary(m12)
m13<-glm(internet~as.factor(METRO), data=samp, family=binomial)
summary(m13)
mfinal<-glm(internet~TRANTIME+INCTOT+AGE + as.factor(PHONE)+as.factor(race_int)+as.factor(DIFFEYE), data=samp, family=binomial)
summary(mfinal)
```
DIFFEYE: 2=blindness 1=sightedness
I want to try to combine categories 2-4 in METRO

```{r}
# Lauren messing around

m14 <- glm(internet~as.factor(HHINCOME), data = samp, family = binomial)
summary(m14)
```

